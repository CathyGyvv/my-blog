## 通过webpack怎么具体做代码的处理???

1.url-loader 将limit匹配的图片转换为base64，其内部使用了file-loader,只是多了一步base64的转换， file-loader 默认在内部生成图片，也可以处理字体文件，并打包，image-webpack-loader压缩图片

2.打包之后都会有一个.map文件跟随,做了一个打包文件和源文件的映射。

3.mini-css-extract-plugin,将css代码做抽离,postcss-loader中autoprefixer自动加浏览器前缀 

4.eslint-loader做代码格式的优化

5.expose-loader暴露全局变量的loader,webpack.ProvidePlugin在每一个文件中自动引入全局变量  

6.CopyWebpackPlugin ，复制没经过webpack处理的文件

7.

8.webpack.DefinePlugin创建一些在编译时可以配置的全局常量，在代码中可以访问
wwebpack.DllPluginc抽离第三方模块

9. html-webpack-plugin，自动创建HTML文件，引用构建出的JS文件

10.css-loader,处理css中的依赖，@import，url引入的文件，style-loader将css-loader解析的结果转变成js代码,运行时插入style标签，mini-css-extract-plugin,将css代码做抽离，postcss-loader中autoprefixer，自动加浏览器前缀 
  
11.webpack-dev-server启动静态服务


 modules.rules.noParse  不解析此文件，{test，use,exclude,include}的过滤


expose-loader  暴露全局变量 

```js
{
  test: require.resolve('jquery'),
  use: 'expose-loader?$'
}
```


### 性能相关
SpeedMeasurePlugin 将每一个plugin，每一个loader的打包时间以及总时长打包统计

loader的加载方式： pre前置Loader，normal-loader, 内联loader, 后置loader
webpack-build-notifier提示构建完成

BundleAnalyzerPlugin 将各个包的内容，信息以图形化界面展现出来

clean-webpack-plugin 清除上次打包的文件

tree shaking(去除无用代码,css的，js的)和uglifyjs(代码压缩混淆)

cache-loader 文件较之前的没有发生变化则会直接使用缓存

happypack 分配任务到子进程，减少构建时间 ，插件

webpack-parallel-uglify-plugin 优化代码的压缩时间

HotModuleReplacementPlugin，开发环境，局部更改刷新,HMR

react-hot-loader 在代码中引入

pwa优化

## webpack做了什么,宏观角度

构建我们发布需要的 HTML、CSS、JS 文件
使用 CSS 预处理器来编写样式
处理和压缩图片
使用 Babel 来支持 ES 新特性
本地提供静态服务以方便开发调试

### 生产环境
更小的bundle压缩，轻量的source map，优化资源，tree shaking去掉多余代码

### 开发环境
热更新，source map,localhost server,
devtool:cheap-module-eval-source-map 


### loader的加载顺序： pre前置Loader，normal-loader, 内敛loader, 后置loader 'post loader ',  enforce: ''                

 loader 按照前置 -> 行内 -> 普通 -> 后置的顺序执行



webpack做缓存

plugins: [
   new webpack.optimize.CommonsChunkPlugin('vendors', 'vendors.js')
 ]
 对于每次构建，vendor hash 都应该保持一致，用插件可以做到

react-hot-loader做了什么



## 开发环境
不进行代码压缩
打印debug信息
包含sourcemap文件
热更新

## 生产环境
以上3个反过来

自动做代码优化，用不到的代码删除js

html-webpack-plugin通过配置项可以压缩css,html


## webpack提升构建速度

1.减少resolve的解析,过滤node_modules，后缀名减少
2.loader应用的文件范围缩小，include字段指定需要转换的文件范围
3.一处没有必要的plugin，比如生产环境自动压缩代码，去掉无用代码


### webpack的配置项优化

webpack.IgnorePlugin忽略第三方的不需要的依赖包


loader的extral忽略一些不必要的文件

webpack.DLLPlugin将react这种第三方包做抽离

happypack   多线程打包
babel-plugin-syntax-dynamic-import ???


polyfill.io 动态加载polyfill




### es6的转换

yarn add babel-loader @babel/core @babel/preset-env -D     
                                       (预设)
配置Loader
```js
{
  test: /\.js$/,
  use: {
    loader: 'babel-loader',
    options: {
      presets: [
        '@babel/preset-env'
      ],
       plugins: [
              '@babel/plugin-proposal-class-properties'
            ]
    }
  }
}
```

### 添加polyfill

yarn add @babel/plugin-transform-runtime @babel/runtime -D
```js
 plugins: [
    '@babel/plugin-proposal-class-properties',
    '@babel/plugin-transform-runtime'
  ]
```

yarn add @babel/polyfill -D
import '@babel/polyfill';
或者
module.exports = {
  entry: ["@babel/polyfill", "./app/js"],
};

### 提前打包静态文件，比如react,react-dom

plugins: [
  new webpack.DLLReferencePlugin({
    manifest: path.resolve(__dirname,'dist','manifest.json')
  })
]


https://juejin.im/post/5de87444518825124c50cd36#heading-23

https://juejin.im/post/5cfe4b13f265da1bb13f26a8
 



  entry 可以是多入口 
  ```js
  module.export = {
    entry: {
      ...
    }
  }
  ``` 

  output 只有一个出口 

  webpack本身只能处理js，loader可以把其他的文件进行转换 

  babel-loader   转换es6,7等新特性的语法  

  thread-loader 多进程打包js和css

  commonsChunkPlugin 将chunks相同的模块代码提取成公共JS  

  ZipWebpackPlugin 将打包出的资源生成一个zip包 


  ### ES6的转换 

  babel-loader的使用，然后配置.babelrc文件 
  (@babel/core是做什么的)
  ```js
  {
    "presets": [
      // 一个presets,表示很多plugins的集合 
      "@babel/preset-env" // 解析es6
      "@babel/preset-react" // 解析jsx
    ],
    "plugins": [
      // 一个plugins对应一个功能
      "@babel/proposal-class-properties"
    ]
  }
  ```

### 文件指纹  （hash值）

做版本管理 

  hash: 和整个项目的构建相关 ，只要项目文件有修改，整个项目构建的hash值就会更改 

  chunkhash： 和webpack 打包的chunk有关，不同的entry会生成不同的chunkhash值 

  contenthash: 根据文件内容来定义hash，文件内容不变，则contenthash不变 

### 压缩文件 

css压缩： optimize-css-assets-webpack-plugin 
js压缩： 生产环境自动压缩 
html压缩： htmlwebpackplugin指定参数  


px2rem-loader,px到rem的转换  


splitChunksPlugin 代替commonsChunkPlugin插件 
optimization.splitchunks 可以做到下面这个
htmlWebpackExternalsPlugin 抽离公共资源 以cdn的形式引入（react,react-dom）